 # ğŸ‘¨â€ğŸ’» Há»‡ thá»‘ng Nháº­n diá»‡n KhuÃ´n máº·t

Má»™t há»‡ thá»‘ng nháº­n diá»‡n khuÃ´n máº·t hoÃ n chá»‰nh sá»­ dá»¥ng OpenCV vÃ  Python, há»— trá»£ cáº£ phÃ¡t hiá»‡n khuÃ´n máº·t cÆ¡ báº£n vÃ  nháº­n diá»‡n ngÆ°á»i dÃ¹ng cá»¥ thá»ƒ.

## ğŸ“‹ YÃªu cáº§u há»‡ thá»‘ng

- **Python**: 3.7 - 3.11 (khuyáº¿n nghá»‹ 3.9+)
- **Há»‡ Ä‘iá»u hÃ nh**: Windows 10/11, macOS, Linux
- **RAM**: Tá»‘i thiá»ƒu 4GB (khuyáº¿n nghá»‹ 8GB+)
- **Webcam**: TÃ¹y chá»n (cho cháº¿ Ä‘á»™ thá»i gian thá»±c)

## ğŸ› ï¸ CÃ i Ä‘áº·t

### BÆ°á»›c 1: Clone hoáº·c táº£i dá»± Ã¡n

```bash
git clone <repository-url>
cd face-detection
```

### BÆ°á»›c 2: Táº¡o mÃ´i trÆ°á»ng áº£o (khuyáº¿n nghá»‹)

```bash
# Windows
python -m venv venv
venv\Scripts\activate

# macOS/Linux
python3 -m venv venv
source venv/bin/activate
```

### BÆ°á»›c 3: CÃ i Ä‘áº·t thÆ° viá»‡n

#### CÃ i Ä‘áº·t tá»« requirements.txt (khuyáº¿n nghá»‹):

```bash
pip install -r requirements.txt
```

#### Hoáº·c cÃ i Ä‘áº·t tá»«ng thÆ° viá»‡n:

```bash
# ThÆ° viá»‡n chÃ­nh
pip install opencv-python==4.8.1.78
pip install opencv-contrib-python==4.8.1.78
pip install numpy==1.24.3

# ThÆ° viá»‡n bá»• sung
pip install argparse  # ÄÃ£ cÃ³ sáºµn trong Python 3.2+
pip install json      # ÄÃ£ cÃ³ sáºµn
pip install pickle    # ÄÃ£ cÃ³ sáºµn
pip install datetime  # ÄÃ£ cÃ³ sáºµn
pip install os        # ÄÃ£ cÃ³ sáºµn
pip install time      # ÄÃ£ cÃ³ sáºµn
```

### BÆ°á»›c 4: Táº¡o file requirements.txt (náº¿u chÆ°a cÃ³)

```txt
opencv-python==4.8.1.78
opencv-contrib-python==4.8.1.78
numpy==1.24.3
```

## ğŸ“ Cáº¥u trÃºc thÆ° má»¥c

```
face-detection/
â”œâ”€â”€ haarcascades/                 # ThÆ° má»¥c chá»©a code chÃ­nh
â”‚   â”œâ”€â”€ detect_from_image.py     # Nháº­n diá»‡n tá»« áº£nh
â”‚   â”œâ”€â”€ detect_from_webcam.py    # Nháº­n diá»‡n tá»« webcam
â”‚   â”œâ”€â”€ face_detector.py         # Class phÃ¡t hiá»‡n khuÃ´n máº·t
â”‚   â”œâ”€â”€ face_recognizer.py       # Class nháº­n diá»‡n ngÆ°á»i dÃ¹ng
â”‚   â”œâ”€â”€ manage_users.py          # Quáº£n lÃ½ cÆ¡ sá»Ÿ dá»¯ liá»‡u ngÆ°á»i dÃ¹ng
â”‚   â””â”€â”€ haarcascade_frontalface_default.xml
â”œâ”€â”€ images/                      # ThÆ° má»¥c chá»©a áº£nh Ä‘áº§u vÃ o
â”œâ”€â”€ results/                     # ThÆ° má»¥c chá»©a káº¿t quáº£
â”œâ”€â”€ user_data/                   # Dá»¯ liá»‡u ngÆ°á»i dÃ¹ng (tá»± Ä‘á»™ng táº¡o)
â””â”€â”€ readme.md                    # File hÆ°á»›ng dáº«n nÃ y
```

## ğŸš€ HÆ°á»›ng dáº«n sá»­ dá»¥ng

### 1. PhÃ¡t hiá»‡n khuÃ´n máº·t tá»« áº£nh

```bash
cd haarcascades

# PhÃ¡t hiá»‡n khuÃ´n máº·t cÆ¡ báº£n
python detect_from_image.py --image test.jpg

# Vá»›i tÃ¹y chá»n thÃªm
python detect_from_image.py --image test.jpg --resize 800x600 --extract-faces
```

**Tham sá»‘ cÃ³ thá»ƒ sá»­ dá»¥ng:**
- `--image`: TÃªn file áº£nh (báº¯t buá»™c)
- `--cascade`: File cascade (máº·c Ä‘á»‹nh: haarcascade_frontalface_default.xml)
- `--output`: TÃªn file káº¿t quáº£
- `--resize`: KÃ­ch thÆ°á»›c Ä‘áº§u ra (vd: 800x600 hoáº·c 0.5)
- `--extract-faces`: LÆ°u tá»«ng khuÃ´n máº·t riÃªng biá»‡t

### 2. Nháº­n diá»‡n khuÃ´n máº·t tá»« webcam

```bash
# PhÃ¡t hiá»‡n cÆ¡ báº£n
python detect_from_webcam.py

# Liá»‡t kÃª camera kháº£ dá»¥ng
python detect_from_webcam.py --list-cameras

# Vá»›i cÃ¡c tÃ¹y chá»n
python detect_from_webcam.py --camera 0 --save-video --fps 30
```

**PhÃ­m Ä‘iá»u khiá»ƒn:**
- `q`: ThoÃ¡t chÆ°Æ¡ng trÃ¬nh
- `s`: Chá»¥p áº£nh mÃ n hÃ¬nh

**Tham sá»‘ webcam:**
- `--camera`: Chá»‰ sá»‘ camera (0, 1, 2...)
- `--save-video`: LÆ°u video káº¿t quáº£
- `--width/--height`: Äá»™ phÃ¢n giáº£i camera
- `--brightness/--contrast`: Äiá»u chá»‰nh camera

### 3. Quáº£n lÃ½ ngÆ°á»i dÃ¹ng

#### ThÃªm ngÆ°á»i dÃ¹ng má»›i:
```bash
python manage_users.py add --id khiem --name "Nguyen Van Khiem" --image khiem1.jpg
```

#### Liá»‡t kÃª táº¥t cáº£ ngÆ°á»i dÃ¹ng:
```bash
python manage_users.py list
```

#### ThÃªm áº£nh khuÃ´n máº·t bá»• sung:
```bash
python manage_users.py add-face --id khiem --image khiem2.jpg
```

#### Liá»‡t kÃª áº£nh cá»§a má»™t ngÆ°á»i dÃ¹ng:
```bash
python manage_users.py list-faces --id khiem
```

#### XÃ³a áº£nh khuÃ´n máº·t:
```bash
python manage_users.py remove-face --id khiem --index 1
```

#### XÃ³a ngÆ°á»i dÃ¹ng:
```bash
python manage_users.py delete --id khiem
```

### 4. Nháº­n diá»‡n ngÆ°á»i dÃ¹ng Ä‘Ã£ Ä‘Äƒng kÃ½

```bash
# Tá»« áº£nh
python detect_from_image.py --image test.jpg --recognition-mode --confidence 50

# Tá»« webcam
python detect_from_webcam.py --recognition-mode --confidence 50 --show-details
```

**Tham sá»‘ nháº­n diá»‡n:**
- `--recognition-mode`: Báº­t cháº¿ Ä‘á»™ nháº­n diá»‡n ngÆ°á»i dÃ¹ng
- `--confidence`: NgÆ°á»¡ng Ä‘á»™ tin cáº­y (0-100, tháº¥p = nghiÃªm ngáº·t hÆ¡n)
- `--show-details`: Hiá»ƒn thá»‹ thÃ´ng tin chi tiáº¿t

## ğŸ”§ Xá»­ lÃ½ lá»—i thÆ°á»ng gáº·p

### 1. Lá»—i import cv2
```bash
# Gá»¡ cÃ i Ä‘áº·t phiÃªn báº£n cÅ©
pip uninstall opencv-python opencv-contrib-python

# CÃ i Ä‘áº·t láº¡i
pip install opencv-python==4.8.1.78
pip install opencv-contrib-python==4.8.1.78
```

### 2. Lá»—i khÃ´ng tÃ¬m tháº¥y camera
```bash
# Kiá»ƒm tra camera kháº£ dá»¥ng
python detect_from_webcam.py --list-cameras

# Thá»­ camera khÃ¡c
python detect_from_webcam.py --camera 1
```

### 3. Lá»—i file khÃ´ng tá»“n táº¡i
- Äáº£m báº£o áº£nh Ä‘áº§u vÃ o Ä‘Æ°á»£c Ä‘áº·t trong thÆ° má»¥c `images/`
- Kiá»ƒm tra tÃªn file chÃ­nh xÃ¡c (phÃ¢n biá»‡t hoa thÆ°á»ng)

### 4. Lá»—i Face Recognizer
```bash
# CÃ i Ä‘áº·t opencv-contrib-python (chá»©a face recognition)
pip install opencv-contrib-python==4.8.1.78
```

## ğŸ“Š Cáº¥u trÃºc dá»¯ liá»‡u

### File cÆ¡ sá»Ÿ dá»¯ liá»‡u ngÆ°á»i dÃ¹ng (user_data/users_database.json):
```json
{
  "user_id": {
    "name": "TÃªn ngÆ°á»i dÃ¹ng",
    "face_image": "Ä‘Æ°á»ng/dáº«n/áº£nh.jpg",
    "created_at": "2024-01-01 10:00:00",
    "last_recognized": "2024-01-01 15:30:00"
  }
}
```

## ğŸ’¡ Gá»£i Ã½ tá»‘i Æ°u

### Cháº¥t lÆ°á»£ng áº£nh huáº¥n luyá»‡n:
- Sá»­ dá»¥ng áº£nh cÃ³ Ä‘á»™ phÃ¢n giáº£i cao (tá»‘i thiá»ƒu 200x200 pixel)
- Ãnh sÃ¡ng Ä‘á»u, khÃ´ng quÃ¡ tá»‘i hoáº·c quÃ¡ sÃ¡ng
- KhuÃ´n máº·t nhÃ¬n tháº³ng vÃ o camera
- KhÃ´ng bá»‹ che khuáº¥t bá»Ÿi kÃ­nh, kháº©u trang

### CÃ i Ä‘áº·t tham sá»‘:
- **Confidence threshold**: 30-70 (tháº¥p = nghiÃªm ngáº·t, cao = dá»… dÃ£i)
- **Camera resolution**: 640x480 hoáº·c 1280x720
- **FPS**: 20-30 cho webcam

## ğŸ†˜ Há»— trá»£

### Kiá»ƒm tra phiÃªn báº£n:
```python
import cv2
import numpy as np
print(f"OpenCV version: {cv2.__version__}")
print(f"NumPy version: {np.__version__}")
```

### Test cÆ¡ báº£n:
```python
import cv2
# Test camera
cap = cv2.VideoCapture(0)
if cap.isOpened():
    print("Camera hoáº¡t Ä‘á»™ng bÃ¬nh thÆ°á»ng")
    cap.release()
else:
    print("KhÃ´ng thá»ƒ má»Ÿ camera")
```

## ğŸ“ Ghi chÃº phiÃªn báº£n

- **Python 3.7-3.11**: ÄÆ°á»£c há»— trá»£ Ä‘áº§y Ä‘á»§
- **OpenCV 4.8.1.78**: PhiÃªn báº£n á»•n Ä‘á»‹nh, cÃ³ Ä‘áº§y Ä‘á»§ tÃ­nh nÄƒng
- **NumPy 1.24.3**: TÆ°Æ¡ng thÃ­ch tá»‘t vá»›i OpenCV

**LÆ°u Ã½**: TrÃ¡nh sá»­ dá»¥ng Python 3.12+ vÃ¬ cÃ³ thá»ƒ cÃ³ váº¥n Ä‘á» tÆ°Æ¡ng thÃ­ch vá»›i má»™t sá»‘ phiÃªn báº£n OpenCV.

## ğŸ”„ Cáº­p nháº­t

Äá»ƒ cáº­p nháº­t lÃªn phiÃªn báº£n má»›i:
```bash
pip install --upgrade opencv-python opencv-contrib-python numpy
```

---

**TÃ¡c giáº£**: [TÃªn cá»§a báº¡n]  
**NgÃ y táº¡o**: [NgÃ y hiá»‡n táº¡i]  
**PhiÃªn báº£n**: 1.0.0